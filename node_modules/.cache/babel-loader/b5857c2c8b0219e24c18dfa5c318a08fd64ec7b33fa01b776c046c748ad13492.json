{"ast":null,"code":"import'./AddTodoComponent.css';import{getAuthToken}from'../util/auth';import{Form,redirect,json,useActionData}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AddTodoComponent(){//실패경우1 - \nconst data=useActionData();console.log(\"useActionData:\",data);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Todo Add!\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form,{method:\"post\",children:[data&&data.message&&/*#__PURE__*/_jsx(\"p\",{children:data.message}),/*#__PURE__*/_jsxs(\"fieldset\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control\",name:\"description\"})]}),/*#__PURE__*/_jsxs(\"fieldset\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Target Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",className:\"form-control\",name:\"targetDate\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"userid\",className:\"form-control\"}),/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"done\",className:\"form-control\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success m-5\",children:\"Save\"})})]})})]});}export async function action(_ref){let{request}=_ref;alert(\"AddTodoComponent. action\");const userid=localStorage.getItem(\"userid\");// const token = getAuthToken();\n// 회원가입폼 데이터 얻기\nconst data=await request.formData();console.log(\"data>>\",data);const authData={description:data.get('description'),targetDate:data.get('targetDate'),userid:userid};console.log(\"authData>>\",authData);const token=getAuthToken();const response=await fetch(`http://localhost:8090/todo/users/${userid}/todos`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${token}`},body:JSON.stringify(authData)});console.log(\"회원가입 요청결과:\",response);//실패경우1 -  14 라인과 23 라인에서 에외처리함\nif(response.status===400||response.status===401||response.status===422){console.log(\"response.status>>\",response.status);return response;}return redirect('/Todos');}//end action\nexport default AddTodoComponent;","map":{"version":3,"names":["getAuthToken","Form","redirect","json","useActionData","jsx","_jsx","jsxs","_jsxs","AddTodoComponent","data","console","log","className","children","method","message","type","name","action","_ref","request","alert","userid","localStorage","getItem","formData","authData","description","get","targetDate","token","response","fetch","headers","Authorization","body","JSON","stringify","status"],"sources":["C:/React_Study/todo_boot_security_jwt_mysql_React소스_컨텍스트명은todo임/src/pages/AddTodoComponent.js"],"sourcesContent":["\r\nimport './AddTodoComponent.css';\r\nimport { getAuthToken } from '../util/auth';\r\nimport {\r\n  Form,\r\n  redirect,\r\n  json,\r\n  useActionData\r\n} from 'react-router-dom';\r\n\r\nfunction AddTodoComponent() {\r\n\r\n   //실패경우1 - \r\n   const data = useActionData();\r\n   console.log(\"useActionData:\", data);\r\n    \r\n\r\n  return (\r\n    <div className=\"container\">\r\n        <h1>Todo Add!</h1>\r\n             <div>\r\n                  <Form  method=\"post\" >\r\n                     {data && data.message && <p>{data.message}</p>}\r\n                      <fieldset className=\"form-group\">\r\n                          <label>Description</label>\r\n                          <input type=\"search\" className=\"form-control\"  name=\"description\"/>\r\n                      </fieldset>\r\n                      <fieldset className=\"form-group\">\r\n                          <label>Target Date</label>\r\n                          <input type=\"date\" className=\"form-control\" name=\"targetDate\"/>\r\n                          \r\n                      </fieldset>\r\n                      \t   <input type=\"text\" name=\"userid\" className=\"form-control\" />\r\n\t\t\t\t                  <input type=\"hidden\" name=\"done\" className=\"form-control\"/>\r\n                      <div>\r\n                          <button className=\"btn btn-success m-5\">Save</button>\r\n                      </div>\r\n                  </Form>\r\n            </div>\r\n  </div>\r\n  );\r\n}\r\n\r\nexport async function action({request}){\r\n  alert(\"AddTodoComponent. action\")\r\n  const userid = localStorage.getItem(\"userid\");\r\n\r\n  // const token = getAuthToken();\r\n  // 회원가입폼 데이터 얻기\r\n  const data = await request.formData();\r\n  console.log(\"data>>\", data);\r\n  const authData = {\r\n    description: data.get('description'),\r\n    targetDate: data.get('targetDate'),\r\n    userid:userid\r\n  };\r\n\r\n  console.log(\"authData>>\", authData);\r\n  const token = getAuthToken();\r\n\r\n  const response = await fetch(`http://localhost:8090/todo/users/${userid}/todos`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n       Authorization: `Bearer ${token}`\r\n    },\r\n    body: JSON.stringify(authData),\r\n  });\r\n\r\n  console.log(\"회원가입 요청결과:\", response);\r\n\r\n  //실패경우1 -  14 라인과 23 라인에서 에외처리함\r\n  if (response.status === 400 || response.status === 401 || response.status === 422) {\r\n    console.log(\"response.status>>\", response.status);\r\n    return response;\r\n  }\r\n\r\n  return redirect('/Todos');\r\n}//end action\r\n\r\nexport default AddTodoComponent;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}